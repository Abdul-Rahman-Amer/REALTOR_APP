<!DOCTYPE html>
<html>
<head>
    <title>Edit Folder: {{ folder_name }}</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <style>
        .image-container {
            display: inline-block;
            border: 1px solid #ccc;
            text-align: center;
            position: relative;
        }

        .image-container img {
            max-width: 100%;
            max-height: 200px;
        }

        .image-container .label {
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            text-align: center;
            padding: 5px 10px;
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .image-container:hover .label {
            opacity: 1;
        }

        .image-container .edit-button {
            position: absolute;
            top: 0;
            right: 35px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .image-container:hover .edit-button {
            opacity: 1;
        }

        .image-container .remove-button {
            position: absolute;
            top: 0;
            right: 5px;
            background-color: #ff4444;
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .image-container:hover .remove-button {
            opacity: 1;
        }

        .big-box {
            border: 2px solid #000;
            padding: 10px;
            text-align: center;
            display: inline-block;
        }

        .upload-container {
            border: 2px dashed #007bff;
            padding: 20px;
            text-align: center;
            background-color: #fff;
            box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.1);
            margin: 20px auto;
            max-width: 400px;
            border-radius: 10px;
            position: relative;
        }

        .upload-container p {
            font-size: 16px;
            color: #555;
            margin: 0;
        }

        .upload-container #drop-area {
            border: 2px dashed #007bff;
            padding: 20px;
            border-radius: 10px;
            color: #007bff;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }

        .upload-container #drop-area.dragover {
            background-color: black;
            color: #fff;
        }

        .upload-container input[type="file"] {
            display: none;
        }

        .upload-container label {
            display: inline-block;
            background-color: #007bff;
            color: #fff;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
        }

        .upload-container label:hover {
            background-color: #0056b3;
        }

        .custom-file-upload {
            display: inline-block;
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border-radius: 10px;
            cursor: pointer;
        }

        .custom-file-upload:hover {
            background-color: #0056b3;
        }

        #description-form {
            border: 2px solid #007bff;
            padding: 20px;
            background-color: #f7f7f7;
            box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.1);
            margin: 20px auto;
            max-width: 400px;
            border-radius: 10px
        }
.container{
    padding: 80px;
}
#description-form h2 {
    color: #007bff;
    font-size: 24px;
    margin-bottom: 10px;
}

#description-form label {
    display: block;
    font-size: 18px;
    margin-bottom: 5px;
}

#description {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

#description-form button {
    background-color: #007bff;
    color: #fff;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
}

#description-form button:hover {
    background-color: #0056b3;
}
#listingDetailsContainer {
            border: 2px solid #ccc;
            padding: 20px;
            margin: 20px;
            border-radius: 10px;
        }

        #listingDetailsContainer h2 {
            margin-top: 10px;
        }

        input[type="checkbox"] {
            margin-right: 10px;
        }

        .description-and-checkboxes {
        display: flex;
        justify-content: space-between;
    }

    .checkbox-group {
        width: 85%;
    }
</style>
</head>
<body>
    <div class="container">
        <center>
            <h1>Editing Contents</h1>
        </center>
        <div class="description-and-checkboxes">
            <div id="description-form">
                <h2>Description</h2>
                <form>
                    <label for="description">Enter your description:</label>
                    <textarea id="description" name="description" rows="4" cols="50"></textarea>
                    <br>
                    <button type="submit">Submit Description</button>
                </form>
            </div>
            <div id="listingDetailsContainer">
                <div class="checkbox-group">
                    <h2>Building Features</h2>
                    <input type="checkbox" id="doorman" name="buildingFeatures" value="Doorman">
                    <label for="doorman">Doorman</label><br>
                    <input type="checkbox" id="elevator" name="buildingFeatures" value="Elevator">
                    <label for="elevator">Elevator</label><br>
                    <input type="checkbox" id="fitnessCenter" name="buildingFeatures" value="Fitness Center">
                    <label for="fitnessCenter">Fitness Center</label><br>
                    <input type="checkbox" id="laundryInBuilding" name="buildingFeatures" value="Laundry In Building">
                    <label for="laundryInBuilding">Laundry In Building</label><br>
                    <input type="checkbox" id="commonOutdoorSpace" name="buildingFeatures" value="Common Outdoor Space">
                    <label for="commonOutdoorSpace">Common Outdoor Space</label><br>
                    <input type="checkbox" id="storageFacility" name="buildingFeatures" value="Storage Facility">
                    <label for="storageFacility">Storage Facility</label><br>
                </div>
                <div class="checkbox-group">
                    <h2>Pet Policy</h2>
                    <input type="checkbox" id="catsAllowed" name="petPolicy" value="Cats Allowed">
                    <label for="catsAllowed">Cats Allowed</label><br>
                    <input type="checkbox" id="dogsAllowed" name="petPolicy" value="Dogs Allowed">
                    <label for="dogsAllowed">Dogs Allowed</label><br>
                </div>
            </div>
        </div>
        <div class="upload-container" id="drop-area">
            <p>Drag & Drop photos here or click to select files</p>
            <label for="fileInput" class="custom-file-upload">Choose File</label>
            <input type="file" id="fileInput" multiple>
        </div>
    </div>  

<div class="big-box">
<div class="image-list">
    {% for item in contents %}
        {% if is_image(item) %}
            <div class="image-container">
                <img src="{{ url_for('static', filename=folder_name.lstrip('static/') + '/' + item) }}" alt="Image">
                <div class="label">{{ item }}</div>
                <button class="edit-button" type="button" onclick="openEditDialog('{{ item }}')">&#9998;</button>
                <button class="remove-button" type="button" onclick="removeImage('{{ item }}')">&#10006;</button>
            </div>
        {% endif %}
    {% endfor %}
</div>
</div>
</div>
<div class="modal fade" id="renameModal" tabindex="-1" role="dialog" aria-labelledby="renameModalLabel" aria-hidden="true">
<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="renameModalLabel">Rename Photo</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <p>Current Name: <span id="currentName"></span></p>
            <label for="newName">New Name:</label>
            <input type="text" class="form-control" id="newName">
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" id="saveName">Save Changes</button>
        </div>
    </div>
</div>
</div>
</div>
</body>
<script>
const dropArea = document.getElementById("drop-area");

// Prevent default behaviors
['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
    dropArea.addEventListener(eventName, preventDefaults, false);
});
// Function to open the modal when an image is clicked
function openEditDialog(item) {
    $('#renameModal').modal('show');
    $('#currentName').text(item);
    
    // Extract the extension from the current item
    const extension = item.split('.').pop();
    
    // Set the default value for the new name input field with the extension
    $('#newName').val(item.replace('.' + extension, ''));
    
    // Store the extension in a data attribute for later use
    $('#newName').data('extension', extension);
}

// Function to rename the image and close the modal
$('#saveName').click(function () {
    const currentName = $('#currentName').text();
    const newName = $('#newName').val();
    const extension = $('#newName').data('extension');
    
    // Append the extension to the new name
    const newFullName = newName + '.' + extension;

    // Add logic to rename the image here (send a request to your Flask route)
    // Close the modal
    $('#renameModal').modal('hide');
});

// Function to prevent default behaviors
function preventDefault(e) {
    e.preventDefault();
    e.stopPropagation();
}

// Highlight when dragging over the container
function highlight(e) {
    dropArea.classList.add('highlight');
}

// Unhighlight when not dragging
function unhighlight(e) {
    dropArea.classList.remove('highlight');
}

// Handle dropped files
function handleDrop(e) {
    let dt = e.dataTransfer;
    let files = dt.files;

    handleFiles(files);
    unhighlight();
}

// Handle selected files from input
function handleFiles(files) {
    for (let i = 0; i < files.length; i++) {
        // Handle each file (e.g., upload or process)
        console.log('Uploaded file: ' + files[i].name);
    }
}

// Add event listeners for drag and drop
const dropArea = document.getElementById("drop-area");

dropArea.addEventListener("dragover", function (e) {
    e.preventDefault();
    highlight();
});

dropArea.addEventListener("dragleave", function () {
    unhighlight();
});

dropArea.addEventListener("drop", function (e) {
    e.preventDefault();
    handleDrop(e);
});

// Rest of your JavaScript code for drag-and-drop functionality here...
</script>
<script>
    // Function to open the modal when an image is clicked
    function openEditDialog(item) {
        $('#renameModal').modal('show');
        $('#currentName').text(item);

        // Extract the extension from the current item
        const extension = item.split('.').pop();

        // Set the default value for the new name input field with the extension
        $('#newName').val(item.replace('.' + extension, ''));

        // Store the extension in a data attribute for later use
        $('#newName').data('extension', extension);
    }

    // Function to rename the image and close the modal
    $('#saveName').click(function () {
        const currentName = $('#currentName').text();
        const newName = $('#newName').val();
        const extension = $('#newName').data('extension');

        // Append the extension to the new name
        const newFullName = newName + '.' + extension;

        // Add logic to rename the image here (send a request to your Flask route)
        // Close the modal
        $('#renameModal').modal('hide');
    });

    // Function to prevent default behaviors
    function preventDefault(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    // Highlight when dragging over the container
    function highlight(e) {
        dropArea.classList.add('highlight');
    }

    // Unhighlight when not dragging
    function unhighlight(e) {
        dropArea.classList.remove('highlight');
    }

    // Handle dropped files
    function handleDrop(e) {
        let dt = e.dataTransfer;
        let files = dt.files;

        handleFiles(files);
        unhighlight();
    }

    // Handle selected files from input
    function handleFiles(files) {
        for (let i = 0; i < files.length; i++) {
            // Handle each file (e.g., upload or process)
            console.log('Uploaded file: ' + files[i].name);
        }
    }

    // Rest of your JavaScript code for drag-and-drop functionality here...
</script>


</body>
</html>

